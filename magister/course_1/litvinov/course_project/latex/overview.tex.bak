\section*{Исходные данные}
 
Техническое задание: для заданного объекта управления (ОУ) спроектировать заданный тип регулятора, обеспечивающего в замкнутой системе требуемое время переходного процесса и значение перерегулирования в соответствии с вариантом.

	\begin{table}[H]
		\caption{\label{tab:canonsummary}Вариант задания}
		\begin{center}
			\begin{tabular}{|c|c|c|c|c|c|c|c|}
				\hline
				& & \multicolumn{2}{c|}{W1} & \multicolumn{2}{c|}{W2} & \multicolumn{2}{c|}{W3} \\
				\cline{3-8}
				\raisebox{2ex}[0cm][0cm]{№} & \raisebox{2ex}[0cm][0cm]{T} & K1 & T1 & K2 & T2 & K3 & T3 \\
				\hline
				16 & 0.003 & 30.00 & 0.08 & 60.00 & 0.15 & 0.04 & Интегратор  \\
				\hline
			\end{tabular}
		\end{center}
	\end{table} 

Тип регулятора: Пропорциональный.

Время переходного процесса: 0.084 секунды.

Перерегулирование: 10\%.

\section{Описание системы в уравнениях Вход-Состояние-Выход} 

Заданная система показана на рисунке ~\ref{fig:system1}.

\begin{figure}[h]
	\vspace{5mm}
	\center{
		\includegraphics[width=0.8\textwidth]{overview/1_system.png}
	}	
	\caption{Заданная система}
	\label{fig:system1}
\end{figure}

Представим систему в виде дифференциального уравнения:

\begin{equation}
	\label{system1}
	a_0 y'''(t) + a_1 y''(t) + y'(t) = b u(t)
\end{equation}
где $a_0 = T_1  T_2 = 0.012$, $a_1 = T_1 + T_2 = 0.23$, $b = K_1  K_2  K_3 = 72$.

Введем в рассмотрение переменные состояния:
% y = x1
\begin{align*}
	\dot x_1 &= x_2 \\
	\dot x_2 &= x_3 \\
	\dot x_3 &= -\frac{a_2}{a_0} y' -\frac{a_1}{a_0} y'' +\frac{b}{a_0} u
\end{align*}

Составим векторно-матричную модель ВСВ непрерывной системы:
\begin{align*}
	\dot x(t) &= Ax(t) + Bu(t)\\
	y(t) &= Cx(t)
\end{align*}
где 
\begin{align*}
	A =
	\begin{bmatrix}
		0 & 1 & 0\\
		0 & 0 & 1\\
		0 & -\frac{a_2}{a_0} & -\frac{a_1}{a_0}
	\end{bmatrix}
	=
	\begin{bmatrix}
	0  & 1      &    0\\         
    0 & 0         &  1    \\     
    0 & - 83.333333  &- 19.166667 
	\end{bmatrix},
\end{align*}
\begin{align*}
	B =
	\begin{bmatrix}
		0\\
		0\\
	 	\frac{b}{a_0}
	\end{bmatrix}
	=
	\begin{bmatrix}
	0\\
	0\\
	6000
	\end{bmatrix}
\end{align*}

\begin{align*}
	C =
	\begin{bmatrix}
		1 & 0 & 0
	\end{bmatrix}
\end{align*}

Воспользуемся методом дискретизации с использованием матричной экспоненты, который обеспечивает получение точной дискретной модели блоков.

Дискретная модель ВСВ ОУ в виде разностного уравнения:
\begin{equation}
x (k + 1) = A_d x(k) + B_d u(k)
\end{equation}
\begin{equation}
y(k) = C_d x(k)
\end{equation}
где k -- дискретное время, T -- интервал дискретности

\begin{align*}
	A_d = e^{AT} = I + TA + \frac{T^2}{2!} A^2 + ... + \frac{T^j}{j!} A^j + ... = 	
	\begin{bmatrix}
    1  &  0.0029996  &  0.0000044  \\
    0 &   0.9996321 &   0.0029150  \\
    0 & - 0.2429179  &  0.9437610 
	\end{bmatrix},
\end{align*}

\begin{align*}
	B_d = T(I + \frac{T}{2!} A + \frac{T^2}{3!} A^2 + ... + \frac{T^j}{(j + 1)!} A^j + ...)B =
	\begin{bmatrix}
   0.0000266  \\
    0.0264882  \\
    17.490091 
	\end{bmatrix}
\end{align*}

\begin{align*}
	Cd = C
\end{align*}



\section{Расчет дискретной передаточной функции системы}

Дискретная модель в виде операторного уравнения:
\begin{equation}
	\label{dsystem1}
	y(k) = W(z) u(k)
\end{equation}
где $W(z)$ дискретная передаточная функция.

Выразив из (2) $x(k)$ и подставив в (3) получим (4), откуда выразим $W(z)$.
\begin{align*}
	W(z) = C (zI - A_d)^{-1} B
\end{align*}

Для ее решения прибегнем к функции среды моделирования Scilab: 
\begin{align*}
[Ds,NUM,chi]=ss2tf(sl)
\end{align*}
где $Ds$ -- матрица внешних возмущений D (в нашем случае равна нулю), $NUM$ -- числитель передаточной функции, $chi$ -- характеристический полином системы, $sl$ -- описание линейной системы, результат работы функции -- $[sl]=syslin('d',A_d,B_d,C_d)$.

Получим:
\begin{align*}
W(z) = 
\frac{0.0034155 + 11.698998*z + 6000.003*z^2}{-0.0001000 + 0.0400663*z - 2.9810158*z^2 + z^3}
\end{align*}


\section{Схема и результаты моделирования системы}
На рисунке ~\ref{fig:model} показана схема моделирования. 

Блок $"S/P"$ -- экстраполятор нулевого уровня. Верхняя передаточная функция (ПФ) для непрерывной системы, нижняя для полученной в результате расчетов дискретной системы. 
Также, на схеме имеются два счетчика: первый (слева) задает интервал дискретности, второй (справа) нужен для вывода данных.


\begin{figure}[H]
	\vspace{0mm}
	\center{
		\includegraphics[width=1\textwidth]{overview/model_wp.png}
	}	
	\caption{Схема моделирования}
	\label{fig:model}
\end{figure}

На вход схемы в нулевой момент времени подается единичный импульс. На выходе имеем два сигнала $y(t)$ и $y(k)$, которые через мультиплексор выводятся в рабочее окружение среды Scilab. 

На рисунке ~\ref{fig:modelres} представлены графики для непрерывной (гладкий) и дискретной (ступенчатый) систем. 
\begin{figure}[H]
	\vspace{0mm}
	\center{
		\includegraphics[width=1\textwidth]{overview/model_res.png}
	}	
	\caption{Результаты моделирования}
	\label{fig:modelres}
\end{figure}

\section{Расчет регулятора}

Введем вектор ошибок для режима стабилизации:
\begin{equation}
 e = 
 \begin{bmatrix}
 e_1\\
 e_2\\
 e_3
 \end{bmatrix}
= -
\begin{bmatrix}
x_1\\
x_2\\
x_3
\end{bmatrix}
\end{equation}

В качестве управляющего воздействия будет выступать пропорциональный регулятор:
\begin{equation}
	u = K e
\end{equation}
где $K = [k_1 k_2 k_3]$ -- матрица линейных стационарных обратных связей.

Модель ошибок имеет вид:
\begin{equation*}
 \begin{cases}
	\dot e = A e - Bu\\
	y = -C e
 \end{cases}
\end{equation*}

Проверим, является ли модель ошибок управляемой, для этого рассчитаем матрицу:
\begin{equation}
U = 
\begin{bmatrix}
B & AB & A^2B
\end{bmatrix}
=
\begin{bmatrix}
    0     &  0     &    6000      \\
    0     & 6000   & - 115000    \\
    6000  &- 115000 &   1704166.7  
\end{bmatrix}
\end{equation}

Найдем $det(Y) = -2.16*10^{11}$, так как детерминант не равен нулю, делаем вывод, что система управляема.

Так как по заданию необходимо обеспечить перерегулирование 10\% и порядок модели ОУ равен трем, то выберем полином Баттерворта третьей степени:
\begin{equation}
 D^*_H = \lambda^3 + 2 \omega_0 \lambda^2 + 2 \omega_0^2 \lambda + \omega_0^3
\end{equation}
где $\omega_0$ -- среднегеометрический корень, определяющий быстродействие системы.

\begin{equation}
\omega_0 = \frac{t^*_n}{t_n}
\end{equation}
где $t^*_n$ -- время переходного процесса нормированной переходной характеристики, $t_n$ -- требуемое время переходного процесса.

Так как порядок системы равен трем, то по нормированным переходным характеристикам из [1] выберем $t^*_n = 6$ сек.  

Получим:
\begin{equation}
\omega_0 = \frac{t^*_n}{t_n} = \frac{6}{0.084} = 71.4286
\end{equation}

Следовательно, требуемый характеристический полином:
\begin{equation}
 D^*_H = \lambda^3 + 142.8571 \lambda^2 + 10204.082 \lambda + 364431.49
\end{equation}

Найдем корни полученного характеристического полинома:
\begin{equation*}
 \begin{cases}
 	\lambda_1^* = - 35.714286 + j61.858957  \\
  	\lambda_2^* = - 35.714286 - j61.858957  \\
  	\lambda_3^* =   - 71.428571 
 \end{cases}
\end{equation*}

Сформируем эталонную модель:
\begin{equation*}
 \begin{cases}
	\dot \xi = \Gamma \xi \\
	v = H \xi
 \end{cases}
\end{equation*}

Так как среди корней полинома имеются пара комплексно-сопряженных корней вида $\lambda_{1,2}^* = \alpha^* \pm j \beta^*$ и вещественный корень $\lambda^*_3$, то описание эталонной модели формируется в блочном виде:
\begin{equation}
\Gamma = 
\begin{bmatrix}
\alpha^* & -\beta^* & 0\\
-\beta^* & \alpha^* & 0\\
0&0& \lambda^*_3
\end{bmatrix}
=
\begin{bmatrix}
  - 35.714286   & 61.858957  &  0  \\       
  - 61.858957  &- 35.714286  &  0  \\       
    0         &  0    &     - 71.428571  
\end{bmatrix}
\end{equation}
\begin{equation}
H = 
\begin{bmatrix}
1 & 0 & 1
\end{bmatrix}
\end{equation}

Произведем дискретизацию матрицы $\Gamma$.
\begin{equation}
\Gamma = exp(\Gamma * T) =
\begin{bmatrix}
    0.8983973  &  1.2039127  &  1 \\        
    0.8306250  &  0.8983973  &  1 \\       
    1         &  1         &  0.8071177 
\end{bmatrix}
\end{equation}

Приступим к расчету коэффициентов регулятора методом модального управления.

Решение задачи модального управления состоит в решении алгебраического матричного уравнения типа Сильвестра относительно матрицы $M$ c последующим вычислением искомой матрицы линейных стационарных обратных связей $K$.
\begin{equation*}
 \begin{cases}
	B_d H = M \Gamma_d - A_d M \\
	K_d = -H M^{-1}
 \end{cases}
\end{equation*}

Уравнение типа Сильвестра из этой системы решим в среде моделирования Scilab с помощью функции $M = sylv(-A_d,\Gamma_d, B_dH, 'd')$:

\begin{equation}
M =
\begin{bmatrix}
  - 0.0159255 & - 0.0021065 &   0.0199318\\  
    0.7462523 & - 0.9713344 & - 1.5197819 \\ 
    35.540082 &   86.641891 &   115.49952 
\end{bmatrix} 
\end{equation}

Далее, найдем матрицу линейных стационарных обратных связей:

\begin{equation}
Kd = 
\begin{bmatrix}
K_1 &K_2& K_3\\
\end{bmatrix}
= 
\begin{bmatrix}
60.738581  &  1.6867914  &  0.0206151
\end{bmatrix}
\end{equation}

\section{Моделирование синтезированного регулятора}

\begin{figure}[H]
	\vspace{0mm}
	\center{
		\includegraphics[width=0.7\textwidth]{overview/abcd_fin.png}
	}	
	\caption{Схема моделирования регулятора}
	\label{fig:regulator}
\end{figure}


\begin{figure}[H]
	\vspace{0mm}
	\center{
		\includegraphics[width=0.8\textwidth]{overview/regulator_res_only_c.png}
	}	
	\caption{Результаты моделирования синтезированного регулятора}
	\label{fig:regulatorres}
\end{figure}

\begin{figure}[H]
	\vspace{0mm}
	\center{
		\includegraphics[width=0.8\textwidth]{overview/regulator_res_zoom_only_c.png}
	}	
	\caption{Результаты моделирования (время переходного процесса)}
	\label{fig:regulatorreszoom}
\end{figure}

\section{Вывод}

В этой работе методом модального управления был синтезирован регулятор и построена модель дискретной системы управления, на основе заданной непрерывной модели, которая удовлетворяет требуемым показателям качества.

Из рисунка ~\ref{fig:regulatorreszoom} видно, что время переходного процесса (момент времени, когда график входит в $5\%$-окрестность установившегося значения, и далее не выходит из него) равно $t^*_n$ = 0,0836 сек., что удовлетворяет техническому заданию $t_n$ = 0.084 сек. Перерегулирование также соответствует заданию и не превышает 10\% .